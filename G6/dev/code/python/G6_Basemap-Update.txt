# ---------------------------------------------------------------------------
# G6_Basemap-Update_FGDB.py
# Created on: Fri Nov 13 2009 01:05:14 PM
#   (generated by ArcGIS/ModelBuilder)
# Usage: G6_Basemap-Update_FGDB <FGDB_Path> <Basemap_Data_gdb__3_> 
# ---------------------------------------------------------------------------

# Import system modules
import sys, string, os, arcgisscripting, traceback, datetime, time
msgs = ""
try:
	starttime = datetime.datetime.now()
	# Create the Geoprocessor object
	gp = arcgisscripting.create()

	# Load required toolboxes...
	gp.AddToolbox("d:/Program Files/ArcGIS/ArcToolbox/Toolboxes/Data Management Tools.tbx")
	gp.AddToolbox("d:/Program Files/ArcGIS/ArcToolbox/Toolboxes/Geocoding Tools.tbx")
	gp.overwriteoutput = 1
	
	# Script arguments...
	FGDB_Path = "\\\\cm-sas-geo-ftp1\\x$\\apps\\9_3_SERVICES\\Cache\\Basemap\\Basemap_Data.gdb\\" # provide a default value if unspecified

	Basemap_Data_gdb__3_ = "\\\\cm-sas-geo-ftp1\\x$\\apps\\9_3_SERVICES\\Cache\\Basemap\\Basemap_Data.gdb" # provide a default value if unspecified

	# Local variables...
	v_FGDB_Path_ADMIN_Public_School_District = FGDB_Path + "ADMIN_Public_School_District"
	ADMIN_PUB_SCHOOL_DISTRICTS_SOS = "AGIO_GUEST.sde\\ADMIN.PUB_SCHOOL_DISTRICTS_SOS"
	v_FGDB_Path_ADMIN_House_Districts = FGDB_Path + "ADMIN_House_Districts"
	ADMIN_HOUSE_DISTRICTS_SOS = "AGIO_GUEST.sde\\ADMIN.HOUSE_DISTRICTS_SOS"
	v_FGDB_Path_ADMIN_County_Boundary = FGDB_Path + "ADMIN_County_Boundary"
	ADMIN_COUNTIES_AHTD = "AGIO_GUEST.sde\\ADMIN.COUNTIES_AHTD"
	v_FGDB_Path_ADMIN_Congressional_Districts = FGDB_Path + "ADMIN_Congressional_Districts"
	ADMIN_CONGRESSIONAL_DISTRICTS = "AGIO_GUEST.sde\\ADMIN.CONGRESSIONAL_DISTRICTS"
	v_FGDB_Path_ADMIN_City_Limit = FGDB_Path + "ADMIN_City_Limit"
	ADMIN_CITY_LIMITS_AHTD__5_ = "AGIO_GUEST.sde\\ADMIN.CITY_LIMITS_AHTD"
	v_FGDB_Path_CULT_Populated_Places = FGDB_Path + "CULT_Populated_Places"
	CULTU_POPULATED_PLACES = "AGIO_GUEST.sde\\CULTU.POPULATED_PLACES"
	v_FGDB_Path_CADAS_Township = FGDB_Path + "CADAS_Township"
	CADAS_PLSS_TOWNSHIP_AHTD = "AGIO_GUEST.sde\\CADAS.PLSS_TOWNSHIP_AHTD"
	v_FGDB_Path_CADAS_Section = FGDB_Path + "CADAS_Section"
	CADAS_PLSS_SECTIONS_AHTD = "AGIO_GUEST.sde\\CADAS.PLSS_SECTIONS_AHTD"
	v_FGDB_Path_ADMIN_State_Boundary = FGDB_Path + "ADMIN_State_Boundary"
	ADMIN_STATE_OUTLINE = "AGIO_GUEST.sde\\ADMIN.STATE_OUTLINE"
	v_FGDB_Path_ADMIN_Senate_Districts = FGDB_Path + "ADMIN_Senate_Districts"
	ADMIN_SENATE_DISTRICT_SOS__2_ = "AGIO_GUEST.sde\\ADMIN.SENATE_DISTRICT_SOS"
	v_FGDB_Path_ADMIN_Public_School_District__3_ = FGDB_Path + "ADMIN_Public_School_District"
	ADMIN_PUB_SCHOOL_DISTRICTS_SOS__7_ = "AGIO_GUEST.sde\\ADMIN.PUB_SCHOOL_DISTRICTS_SOS"
	v_FGDB_Path_ADMIN_House_Districts__2_ = FGDB_Path + "ADMIN_House_Districts"
	ADMIN_HOUSE_DISTRICTS_SOS__2_ = "AGIO_GUEST.sde\\ADMIN.HOUSE_DISTRICTS_SOS"
	v_FGDB_Path_TRANSP_Roads_AHTD = FGDB_Path + "TRANSP_Roads_AHTD"
	TRANSP_ROADS_ALL_AHTD = "AGIO_GUEST.sde\\TRANSP.ROADS_ALL_AHTD"
	v_FGDB_Path_TRANSP_Road_LRS = FGDB_Path + "TRANSP_Road_LRS"
	TRANSP_HIGHWAY_LINEAR_REF_SYSTEM_AHTD = "AGIO_GUEST.sde\\TRANSP.HIGHWAY_LINEAR_REF_SYSTEM_AHTD"
	v_FGDB_Path_TRANSP_Railroads = FGDB_Path + "TRANSP_Railroads"
	TRANSP_RAILROAD_AHTD = "AGIO_GUEST.sde\\TRANSP.RAILROAD_AHTD"
	v_FGDB_Path_TRANSP_Interstate = FGDB_Path + "TRANSP_Interstate"
	TRANSP_INTERSTATES_TIGER_2000_MERGE = "AGIO_GUEST.sde\\TRANSP.INTERSTATES_TIGER_2000_MERGE"
	v_FGDB_Path_TRANSP_ACF_Road = FGDB_Path + "TRANSP_ACF_Road"
	TRANSP_ROADS_ACF = "AGIO_GUEST.sde\\TRANSP.ROADS_ACF"
	v_FGDB_Path_CULTU_Geographic_Names = FGDB_Path + "CULTU_Geographic_Names"
	CULTU_GNIS_ALL_USGS = "AGIO_GUEST.sde\\CULTU.GNIS_ALL_USGS"
	v_FGDB_Path_CULTU_County_Seat = FGDB_Path + "CULTU_County_Seat"
	CULTU_COUNTY_SEATS = "AGIO_GUEST.sde\\CULTU.COUNTY_SEATS"
	v_FGDB_Path_ADMIN_Public_School_District__2_ = FGDB_Path + "ADMIN_Public_School_District"
	CULTU_POPULATED_PLACES__2_ = "AGIO_GUEST.sde\\CULTU.POPULATED_PLACES"
	v_FGDB_Path_WATER_NHD_HI_Res_Waterbody = FGDB_Path + "WATER_NHD_HI_Res_Waterbody"
	WATER_NHD_HIGH_RES_WATERBODY_USGS = "AGIO_GUEST.sde\\WATER.NHD_HIGH_RES_WATERBODY_USGS"
	v_FGDB_Path_WATER_NHD_HI_Res_Point = FGDB_Path + "WATER_NHD_HI_Res_Point"
	WATER_NHD_HIGH_RES_POINT_USGS = "AGIO_GUEST.sde\\WATER.NHD_HIGH_RES_POINT_USGS"
	v_FGDB_Path_WATER_NHD_HI_Res_Line = FGDB_Path + "WATER_NHD_HI_Res_Line"
	WATER_NHD_HIGH_RES_LINE_USGS = "AGIO_GUEST.sde\\WATER.NHD_HIGH_RES_LINE_USGS"
	v_FGDB_Path_WATER_NHD_HI_Res_Flowline = FGDB_Path + "WATER_NHD_HI_Res_Flowline"
	WATER_NHD_HIGH_RES_FLOWLINE_USGS = "AGIO_GUEST.sde\\WATER.NHD_HIGH_RES_FLOWLINE_USGS"
	v_FGDB_Path_WATER_NHD_HI_Res_Area = FGDB_Path + "WATER_NHD_HI_Res_Area"
	WATER_NHD_HIGH_RES_AREA_USGS = "AGIO_GUEST.sde\\WATER.NHD_HIGH_RES_AREA_USGS"
	v_FGDB_Path_Quarter_Quadrangles = FGDB_Path + "Quarter_Quadrangles"
	ADMIN_QUARTER_QUADS_CAST = "AGIO_GUEST.sde\\ADMIN.QUARTER_QUADS_CAST"
	v_FGDB_Path_Quadrangles = FGDB_Path + "Quadrangles"
	ADMIN_QUADRANGLES_CAST = "AGIO_GUEST.sde\\ADMIN.QUADRANGLES_CAST"
	Basemap_Data_gdb = "\\\\cm-sas-geo-ftp1\\x$\\apps\\9_3_SERVICES\\Cache\\Basemap\\Basemap_Data.gdb"
	Basemap_Data_gdb__2_ = "F:\\temp\\Basemap_Data.gdb"
	v_FGDB_Path_ = FGDB_Path

	# Process: Copy Features (5)...
	gp.CopyFeatures_management(ADMIN_CITY_LIMITS_AHTD__5_, v_FGDB_Path_ADMIN_City_Limit, "", "0", "0", "0")

	# Process: Copy Features (4)...
	gp.CopyFeatures_management(ADMIN_CONGRESSIONAL_DISTRICTS, v_FGDB_Path_ADMIN_Congressional_Districts, "", "0", "0", "0")

	# Process: Copy Features (3)...
	gp.CopyFeatures_management(ADMIN_COUNTIES_AHTD, v_FGDB_Path_ADMIN_County_Boundary, "", "0", "0", "0")

	# Process: Copy Features (2)...
	gp.CopyFeatures_management(ADMIN_HOUSE_DISTRICTS_SOS, v_FGDB_Path_ADMIN_House_Districts, "", "0", "0", "0")

	# Process: Copy Features (12)...
	gp.CopyFeatures_management(ADMIN_HOUSE_DISTRICTS_SOS__2_, v_FGDB_Path_ADMIN_House_Districts__2_, "", "0", "0", "0")

	# Process: Copy Features...
	gp.CopyFeatures_management(ADMIN_PUB_SCHOOL_DISTRICTS_SOS, v_FGDB_Path_ADMIN_Public_School_District, "", "0", "0", "0")

	# Process: Copy Features (20)...
	gp.CopyFeatures_management(CULTU_POPULATED_PLACES__2_, v_FGDB_Path_ADMIN_Public_School_District__2_, "", "0", "0", "0")

	# Process: Copy Features (11)...
	gp.CopyFeatures_management(ADMIN_PUB_SCHOOL_DISTRICTS_SOS__7_, v_FGDB_Path_ADMIN_Public_School_District__3_, "", "0", "0", "0")

	# Process: Copy Features (10)...
	gp.CopyFeatures_management(ADMIN_SENATE_DISTRICT_SOS__2_, v_FGDB_Path_ADMIN_Senate_Districts, "", "0", "0", "0")

	# Process: Copy Features (9)...
	gp.CopyFeatures_management(ADMIN_STATE_OUTLINE, v_FGDB_Path_ADMIN_State_Boundary, "", "0", "0", "0")

	# Process: Copy Features (8)...
	gp.CopyFeatures_management(CADAS_PLSS_SECTIONS_AHTD, v_FGDB_Path_CADAS_Section, "", "0", "0", "0")

	# Process: Copy Features (7)...
	gp.CopyFeatures_management(CADAS_PLSS_TOWNSHIP_AHTD, v_FGDB_Path_CADAS_Township, "", "0", "0", "0")

	# Process: Copy Features (6)...
	gp.CopyFeatures_management(CULTU_POPULATED_PLACES, v_FGDB_Path_CULT_Populated_Places, "", "0", "0", "0")

	# Process: Copy Features (19)...
	gp.CopyFeatures_management(CULTU_COUNTY_SEATS, v_FGDB_Path_CULTU_County_Seat, "", "0", "0", "0")

	# Process: Copy Features (18)...
	gp.CopyFeatures_management(CULTU_GNIS_ALL_USGS, v_FGDB_Path_CULTU_Geographic_Names, "", "0", "0", "0")

	# Process: Copy Features (27)...
	gp.CopyFeatures_management(ADMIN_QUADRANGLES_CAST, v_FGDB_Path_Quadrangles, "", "0", "0", "0")

	# Process: Copy Features (26)...
	gp.CopyFeatures_management(ADMIN_QUARTER_QUADS_CAST, v_FGDB_Path_Quarter_Quadrangles, "", "0", "0", "0")

	# Process: Copy Features (17)...
	gp.CopyFeatures_management(TRANSP_ROADS_ACF, v_FGDB_Path_TRANSP_ACF_Road, "", "0", "0", "0")

	# Process: Copy Features (16)...
	gp.CopyFeatures_management(TRANSP_INTERSTATES_TIGER_2000_MERGE, v_FGDB_Path_TRANSP_Interstate, "", "0", "0", "0")

	# Process: Copy Features (15)...
	gp.CopyFeatures_management(TRANSP_RAILROAD_AHTD, v_FGDB_Path_TRANSP_Railroads, "", "0", "0", "0")

	# Process: Copy Features (14)...
	gp.CopyFeatures_management(TRANSP_HIGHWAY_LINEAR_REF_SYSTEM_AHTD, v_FGDB_Path_TRANSP_Road_LRS, "", "0", "0", "0")

	# Process: Copy Features (13)...
	gp.CopyFeatures_management(TRANSP_ROADS_ALL_AHTD, v_FGDB_Path_TRANSP_Roads_AHTD, "", "0", "0", "0")

	# Process: Copy Features (25)...
	gp.CopyFeatures_management(WATER_NHD_HIGH_RES_AREA_USGS, v_FGDB_Path_WATER_NHD_HI_Res_Area, "", "0", "0", "0")

	# Process: Copy Features (24)...
	gp.CopyFeatures_management(WATER_NHD_HIGH_RES_FLOWLINE_USGS, v_FGDB_Path_WATER_NHD_HI_Res_Flowline, "", "0", "0", "0")

	# Process: Copy Features (23)...
	gp.CopyFeatures_management(WATER_NHD_HIGH_RES_LINE_USGS, v_FGDB_Path_WATER_NHD_HI_Res_Line, "", "0", "0", "0")

	# Process: Copy Features (22)...
	gp.CopyFeatures_management(WATER_NHD_HIGH_RES_POINT_USGS, v_FGDB_Path_WATER_NHD_HI_Res_Point, "", "0", "0", "0")

	# Process: Copy Features (21)...
	gp.CopyFeatures_management(WATER_NHD_HIGH_RES_WATERBODY_USGS, v_FGDB_Path_WATER_NHD_HI_Res_Waterbody, "", "0", "0", "0")
	
	#added 8/31/2010
	gp.CopyFeatures_management("AGIO_GUEST.sde\\UTILIT.PUBLIC_WATER_SYSTEMS", Basemap_Data_gdb__3_, "", "0", "0", "0")
	gp.CopyFeatures_management("AGIO_GUEST.sde\\ADMIN.FIRE_DISTRICTS_UALR", Basemap_Data_gdb__3_, "", "0", "0", "0")
	gp.CopyFeatures_management("AGIO_GUEST.sde\\ADMIN.JUSTICE_PEACE_DISTRICT", Basemap_Data_gdb__3_, "", "0", "0", "0")
	gp.CopyFeatures_management("AGIO_GUEST.sde\\ADMIN.APPEALS_COURT", Basemap_Data_gdb__3_, "", "0", "0", "0")
	gp.CopyFeatures_management("AGIO_GUEST.sde\\ADMIN.CIRCUIT_COURT", Basemap_Data_gdb__3_, "", "0", "0", "0")
	
	#copy over addrpt and add state field
	v_FGDB_Path_ADDRESS_POINTS = FGDB_Path + "ADDRESS_POINTS"
	ADDRESS_POINTS = "AGIO_GUEST.sde\\STRUC.SITUS_ADDRESS_PT"
	gp.CopyFeatures_management(ADDRESS_POINTS, v_FGDB_Path_ADDRESS_POINTS, "", "0", "0", "0")
	
	#update the locators
	# Local variables...
	Zip9_Locator = "\\\\cm-sas-geo-ftp1\\x$\\apps\\9_3_SERVICES\\Cache\\Basemap\\Basemap_Data.gdb\\Zip9_Locator"
	AddPt_Locator = "\\\\cm-sas-geo-ftp1\\x$\\apps\\9_3_SERVICES\\Cache\\Basemap\\Basemap_Data.gdb\\AddPt_Locator"
	ACF_Locator = "\\\\cm-sas-geo-ftp1\\x$\\apps\\9_3_SERVICES\\Cache\\Basemap\\Basemap_Data.gdb\\ACF_Locator"

	# Process: Rebuild Address Locator...
	gp.RebuildAddressLocator_geocoding(Zip9_Locator)	
	gp.RebuildAddressLocator_geocoding(AddPt_Locator)
	gp.RebuildAddressLocator_geocoding(ACF_Locator)
	
	# Process: Compress File Geodatabase Data...
	gp.CompressFileGeodatabaseData_management(Basemap_Data_gdb__3_)
	print "G6 FGDB Updated!"
	endtime = datetime.datetime.now()
	elapsed = (endtime - starttime)
	print "Finished at:", endtime.strftime("%b %d %Y %H:%M:%S")
	print "Elapsed time:", elapsed
	os.system("..\send_email.vbs  \"G6 FGDB Update script ran successfully. Elapsed time: " + str(elapsed) + "\" \"G6 FGDB Update Script\"")
except arcgisscripting.ExecuteError:
    # Get the geoprocessing error messages
    #
    msgs = gp.GetMessage(0)
    msgs += gp.GetMessages(2)

    # Return gp error messages for use with a script tool
    #
    gp.AddError(msgs)

    # Print gp error messages for use in Python/PythonWin
    #
    print msgs
    os.system("..\send_email.vbs  \"G6 FGDB Update script had an error: " + msgs.replace('\n',' ') + "\" \"G6 FGDB Update Script Error!\"")	
except:
    # Get the traceback object
    #
    tb = sys.exc_info()[2]
    tbinfo = traceback.format_tb(tb)[0]

    # Concatenate information together concerning the error into a 
    #   message string
    #
    pymsg = tbinfo + "\n" + str(sys.exc_type)+ ": " + str(sys.exc_value)

    # Return python error messages for use with a script tool
    #
    gp.AddError(pymsg)
    
    # Print Python error messages for use in Python/PythonWin
    #
    print pymsg
    os.system("..\send_email.vbs  \"G6 FGDB Update script had an error: " + msgs.replace('\n',' ') + pymsg.replace('\n',' ') + "\" \"G6 FGDB Update Script Error!\"")	